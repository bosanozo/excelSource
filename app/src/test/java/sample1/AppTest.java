/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package sample1;

//import org.junit.jupiter.api.Test;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

import static org.junit.jupiter.api.Assertions.*;

import java.io.IOException;

import com.google.api.client.http.ByteArrayContent;
import com.google.api.client.http.GenericUrl;
import com.google.api.client.http.HttpRequest;
import com.google.api.client.http.HttpRequestFactory;
import com.google.api.client.http.HttpResponse;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.gson.Gson;

class AppTest {
    private static final String baseUrl = "https://u57nfat2zh.execute-api.ap-northeast-1.amazonaws.com/prod/v1/";
    private static final JsonFactory jsonFactory = null;// new JacksonFactory();
    private HttpRequestFactory reqFactory = new NetHttpTransport().createRequestFactory();

    @ParameterizedTest
    @ExcelSource(file = "../test1.xlsx", sheet = "Sheet1")
    void test1(TestData testData) {
        GenericUrl url = new GenericUrl(baseUrl + testData.getPath());
        try {
            HttpRequest request = reqFactory.buildRequest(testData.getMethod(), url, null);
            request.setThrowExceptionOnExecuteError(false);
            if (testData.getInput() != null) {
                System.out.println("input: " + testData.getInput());
                request.setContent(ByteArrayContent.fromString("application/json", testData.getInput()));
            }
            HttpResponse response = request.execute();
            System.out.println("status: " + response.getStatusCode());            
            System.out.println("response: " + response.getContent());
            assertEquals(testData.getStatus(), response.getStatusCode());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // @Test
    //@ParameterizedTest
    @ValueSource(strings = { "Java", "java", "JAVA" })
    void test2(String s) {
        System.out.println(s);
        App classUnderTest = new App();
        assertNotNull(classUnderTest.getGreeting(), "app should have a greeting");
    }
}
